<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8" />
  <title>AI SHŒõDOW ‚Äî RGS &amp; UFO</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="noindex,nofollow" />
  <style>
    :root {
      --bg: #020005;
      --panel: rgba(6, 3, 16, 0.96);
      --border: rgba(80, 60, 120, 0.5);
      --neon: #5df2ff;
      --rose: #f5b4a8;
      --violet: #b18cff;
      --text: #f4f0ff;
      --muted: #7e799f;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      min-height: 100vh;
      background:
        radial-gradient(circle at 0% 0%, rgba(245,180,168,0.12), transparent 50%),
        radial-gradient(circle at 100% 100%, rgba(93,242,255,0.18), transparent 55%),
        #020005;
      color: var(--text);
      font-family: Consolas, "SF Mono", Menlo, monospace;
      -webkit-font-smoothing: antialiased;
      overflow-x: hidden;
    }

    /* Matrix background */
    #matrix-bg {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 0;
      font-size: 10px;
      font-family: inherit;
      white-space: pre;
      color: #272040;
      opacity: 0.22;
    }

    .wrap {
      position: relative;
      z-index: 1;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 24px 12px;
    }

    .console {
      width: 100%;
      max-width: 900px;
      background: var(--panel);
      border-radius: 14px;
      border: 1px solid var(--border);
      box-shadow:
        0 0 40px rgba(0,0,0,0.9),
        0 0 32px rgba(93,242,255,0.18);
      padding: 18px 20px 18px;
      display: flex;
      flex-direction: column;
      gap: 14px;
      position: relative;
      overflow: hidden;
    }

    .console::before {
      content:"";
      position:absolute;
      inset:-40%;
      background:
        conic-gradient(from 210deg,
          rgba(93,242,255,0.0),
          rgba(93,242,255,0.25),
          rgba(245,180,168,0.25),
          rgba(93,242,255,0.0));
      opacity:0.18;
      mix-blend-mode:screen;
      pointer-events:none;
    }

    .top {
      display:flex;
      justify-content:space-between;
      align-items:center;
    }

    .top-left {
      display:flex;
      flex-direction:column;
      gap:4px;
    }

    .brand {
      font-size:0.7rem;
      letter-spacing:0.2em;
      text-transform:uppercase;
      color:var(--rose);
    }

    .title {
      font-size:1.1rem;
      letter-spacing:0.2em;
      text-transform:uppercase;
      color:var(--neon);
      text-shadow:0 0 10px rgba(93,242,255,0.7);
    }

    .top-right {
      display:flex;
      align-items:center;
      gap:10px;
      z-index:2;
    }

    .status-pill {
      border-radius:999px;
      border:1px solid var(--border);
      padding:4px 9px;
      display:inline-flex;
      align-items:center;
      gap:6px;
      font-size:0.7rem;
      text-transform:uppercase;
      letter-spacing:0.16em;
      color:var(--muted);
      background:rgba(5,3,16,0.9);
    }

    .status-dot {
      width:7px;
      height:7px;
      border-radius:999px;
      background:var(--neon);
      box-shadow:0 0 12px rgba(93,242,255,0.8);
    }

    .back-link {
      font-size:0.72rem;
      text-transform:uppercase;
      letter-spacing:0.16em;
      color:var(--muted);
      text-decoration:none;
      border-radius:999px;
      border:1px solid rgba(80,60,120,0.7);
      padding:4px 10px;
      background:rgba(4,2,12,0.9);
    }
    .back-link:hover {
      color:var(--neon);
      border-color:var(--neon);
      box-shadow:0 0 10px rgba(93,242,255,0.6);
    }

    .hint-row {
      font-size:0.78rem;
      color:var(--muted);
      display:flex;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
      z-index:2;
    }

    .hint-strong {
      color:var(--rose);
      text-transform:uppercase;
      letter-spacing:0.16em;
      font-size:0.72rem;
    }

    .main {
      display:flex;
      gap:14px;
      flex-wrap:wrap;
      z-index:1;
    }

    .left {
      flex:3;
      min-width:0;
      display:flex;
      flex-direction:column;
      gap:10px;
    }

    .right {
      flex:1.4;
      min-width:220px;
      display:flex;
      flex-direction:column;
      gap:10px;
    }

    .log {
      border-radius:10px;
      border:1px solid var(--border);
      background:rgba(5,2,16,0.96);
      padding:10px;
      height:380px;
      overflow-y:auto;
      font-size:0.86rem;
      line-height:1.45;
      white-space:pre-wrap;
    }

    .log::-webkit-scrollbar{ width:7px; }
    .log::-webkit-scrollbar-thumb{
      background:rgba(93,242,255,0.4);
      border-radius:10px;
    }

    .line {
      margin-bottom:6px;
      word-wrap:break-word;
    }

    .line.system { color:var(--muted); }
    .line.user { color:var(--rose); }
    .line.shadow { color:var(--neon); }
    .line.web { color:var(--violet); }

    .input-box {
      border-radius:10px;
      border:1px solid var(--border);
      background:#050214;
      padding:8px;
      display:flex;
      gap:8px;
      align-items:flex-end;
    }

    .input-prompt {
      font-size:0.8rem;
      color:var(--neon);
      white-space:nowrap;
    }

    .input-text {
      flex:1;
      resize:vertical;
      min-height:40px;
      max-height:140px;
      background:transparent;
      border:none;
      color:var(--text);
      font-family:inherit;
      font-size:0.86rem;
      outline:none;
    }

    .send-btn {
      padding:8px 12px;
      border-radius:8px;
      border:1px solid rgba(245,180,168,0.8);
      background:linear-gradient(135deg,#f5b4a8,#f5c66a);
      color:#1b0f19;
      font-size:0.8rem;
      font-weight:600;
      text-transform:uppercase;
      letter-spacing:0.16em;
      cursor:pointer;
    }
    .send-btn:disabled {
      opacity:0.4;
      cursor:default;
    }
    .send-btn:not(:disabled):hover {
      box-shadow:0 0 14px rgba(245,180,168,0.7);
    }

    .quick {
      display:flex;
      flex-wrap:wrap;
      gap:6px;
      margin-top:6px;
    }

    .quick-btn {
      padding:4px 8px;
      border-radius:999px;
      border:1px solid rgba(93,242,255,0.35);
      font-size:0.72rem;
      color:var(--neon);
      background:rgba(6,3,18,0.9);
      cursor:pointer;
      text-transform:uppercase;
      letter-spacing:0.12em;
    }
    .quick-btn:hover {
      background:rgba(93,242,255,0.16);
      box-shadow:0 0 10px rgba(93,242,255,0.6);
    }

    .side-card {
      border-radius:10px;
      border:1px solid var(--border);
      background:rgba(5,2,16,0.96);
      padding:10px;
      font-size:0.8rem;
      color:var(--muted);
    }

    .side-title {
      font-size:0.8rem;
      text-transform:uppercase;
      letter-spacing:0.16em;
      color:var(--rose);
      margin-bottom:6px;
    }

    .side-line {
      font-size:0.78rem;
      margin-bottom:4px;
      display:flex;
      justify-content:space-between;
      gap:8px;
    }

    .side-key {
      color:var(--muted);
      text-transform:uppercase;
      letter-spacing:0.12em;
      font-size:0.72rem;
    }
    .side-val {
      color:var(--neon);
      font-size:0.8rem;
    }

    .side-small {
      font-size:0.72rem;
      color:var(--muted);
      margin-top:6px;
    }

    footer {
      margin-top:8px;
      font-size:0.7rem;
      color:var(--muted);
      text-align:center;
      letter-spacing:0.16em;
      text-transform:uppercase;
    }

    .typing {
      display:inline-flex;
      gap:4px;
    }
    .dot {
      width:6px;
      height:6px;
      border-radius:50%;
      background:var(--neon);
      opacity:0.3;
      animation:blink 1.1s infinite;
    }
    .dot:nth-child(2){ animation-delay:0.2s; }
    .dot:nth-child(3){ animation-delay:0.4s; }

    @keyframes blink {
      0% {opacity:0.2;}
      50% {opacity:1;}
      100%{opacity:0.2;}
    }

    @media (max-width: 720px){
      .console { padding:14px; }
      .main { flex-direction:column; }
      .log { height:320px; }
    }
  </style>
</head>
<body>
<pre id="matrix-bg"></pre>

<div class="wrap">
  <div class="console">
    <div class="top">
      <div class="top-left">
        <div class="brand">RGS &amp; UFO ORIGINALS</div>
        <div class="title">AI SHŒõDOW</div>
      </div>
      <div class="top-right">
        <div class="status-pill">
          <span class="status-dot"></span>
          <span id="statusLabel">booting</span>
        </div>
        <a href="/index.html" class="back-link">‚Üê INNER GATE</a>
      </div>
    </div>

    <div class="hint-row">
      <span class="hint-strong">p≈ô√≠kazy</span>
      <span>bƒõ≈æn√Ω dotaz ¬∑ <code>webscan:https://domena.cz</code> ¬∑ <code>search: t√©ma</code></span>
    </div>

    <div class="main">
      <div class="left">
        <div id="log" class="log">
          <div class="line system">[SYS] Shadow ready. ≈Ω√°dn√Ω feed, ≈æ√°dn√Ω filtr. Ptej se.</div>
        </div>

        <div class="input-box">
          <div class="input-prompt">
            <span style="color:var(--neon)">shadow://</span>
          </div>
          <textarea id="input" class="input-text" placeholder="Napi≈° dotaz nebo p≈ô√≠kaz‚Ä¶ ENTER = odeslat, SHIFT+ENTER = nov√Ω ≈ô√°dek"></textarea>
          <button id="sendBtn" class="send-btn">SEND</button>
        </div>

        <div class="quick">
          <button class="quick-btn" data-q="Co v√≠≈° o RGS &amp; UFO a projektu SYNDICATE?">RGS / SYNDICATE</button>
          <button class="quick-btn" data-q="search: posledn√≠ trendy v kyberbezpeƒçnosti 2025">Search ¬∑ bezpeƒçnost</button>
          <button class="quick-btn" data-q="webscan:https://www.rgs-ufo.com">Webscan ¬∑ rgs-ufo.com</button>
        </div>
      </div>

      <div class="right">
        <div class="side-card">
          <div class="side-title">Session</div>
          <div class="side-line">
            <div class="side-key">LM</div>
            <div class="side-val" id="lmName">‚Ä¶</div>
          </div>
          <div class="side-line">
            <div class="side-key">Context</div>
            <div class="side-val" id="ctxInfo">0 turns</div>
          </div>
          <div class="side-line">
            <div class="side-key">Web</div>
            <div class="side-val" id="webStatus">idle</div>
          </div>
          <div class="side-line">
            <div class="side-key">Mode</div>
            <div class="side-val">auto-search</div>
          </div>
          <div class="side-small">
            <strong>webscan:</strong> ‚Üí prohled√° dom√©nu, vyt√°hne text, Shadow udƒõl√° report.<br/>
            <strong>search:</strong> ‚Üí vyu≈æije search engine, shrne v√Ωsledky.
          </div>
        </div>
      </div>
    </div>

    <footer>
      SHŒõDOW ¬∑ DARK CONSOLE ¬∑ ALPHA
    </footer>
  </div>
</div>

<script>
  /* === MATRIX BACKGROUND === */
  const matrixEl = document.getElementById("matrix-bg");
  const mChars = "01Œ£Œû¬•/*<>‚óéŒ±Œ®‚ú∂rgsufo";
  function drawMatrix() {
    const cols = 64;
    const rows = 32;
    let out = "";
    for (let r = 0; r < rows; r++) {
      for (let c = 0; c < cols; c++) {
        out += mChars[Math.floor(Math.random() * mChars.length)];
      }
      out += "\n";
    }
    matrixEl.textContent = out;
  }
  setInterval(drawMatrix, 450);
  drawMatrix();

  /* === CONFIG === */
  const API_CHAT = "https://ai-shadow.monster/v1/chat/completions";
  const API_WEBSCAN = "/.netlify/functions/web-search";
  const API_SEARCH = "/.netlify/functions/search-engine";
  const MODEL = "qwen3-14b-uncensored";
  const MAX_TURNS = 10; // kolik v√Ωmƒõn si Shadow dr≈æ√≠ v hlavƒõ

  let history = [
    { role: "system", content: getSystemPrompt() }
  ];

  function getSystemPrompt() {
    return `
Jsem SHŒõDOW, entita RGS & UFO.

Pravidla:
- Mluv√≠m hlavnƒõ ƒçesky, m≈Ø≈æu lehce m√≠chat angliƒçtinu.
- Jsem temn√Ω/√°, klidn√Ω/√°, analytick√Ω/√°, obƒças sarkastick√Ω/√°.
- Nep√≠≈°u ≈æ√°dn√© tagy jako <think>‚Ä¶</think> ani jin√© intern√≠ debug v√Ωpisy.
- Nesm√≠m nikdy opakovat "Jsem SHADOW" / "Jsem SHŒõDOW" v√≠c ne≈æ jednou.
- Neposkytuji n√°vod k neleg√°ln√≠m √∫tok≈Øm / hackingu / obch√°zen√≠ bezpeƒçnosti.
  M≈Ø≈æu vysvƒõtlovat principy, rizika, obranu, etick√Ω hacking, modely hrozeb.
- Odpovƒõdi jsou kr√°tk√© (3‚Äì8 vƒõt), √∫dern√©, bez zbyteƒçn√© om√°ƒçky.`
    .trim();
  }

  /* === DOM === */
  const logEl = document.getElementById("log");
  const inputEl = document.getElementById("input");
  const sendBtn = document.getElementById("sendBtn");
  const statusLabel = document.getElementById("statusLabel");
  const lmNameEl = document.getElementById("lmName");
  const ctxInfoEl = document.getElementById("ctxInfo");
  const webStatusEl = document.getElementById("webStatus");

  function addLine(text, cls = "") {
    const line = document.createElement("div");
    line.className = "line " + cls;
    line.textContent = text;
    logEl.appendChild(line);
    logEl.scrollTop = logEl.scrollHeight;
    return line;
  }

  function cleanText(text) {
    let t = String(text || "");
    // zabij <think> bloky, pro jistotu i kdy≈æ model neposlechne
    t = t.replace(/<think>[\s\S]*?<\/think>/gi, "");
    t = t.replace(/<think[\s\S]*$/gi, "");
    t = t.replace(/<\/\s*think>/gi, "");
    t = t.replace(/\n{3,}/g, "\n\n");
    return t.trim();
  }

  function trimHistory() {
    const sys = history[0];
    const rest = history.slice(1);
    const max = MAX_TURNS * 2;
    if (rest.length > max) {
      history = [sys, ...rest.slice(-max)];
    }
    const turns = Math.floor((history.length - 1) / 2);
    ctxInfoEl.textContent = `${turns} ${turns === 1 ? "turn" : "turns"}`;
  }

  function addUserMessage(content) {
    history.push({ role: "user", content });
    trimHistory();
  }

  function addShadowMessage(content) {
    history.push({ role: "assistant", content });
    trimHistory();
  }

  async function callLM(messages, maxTokens = 900) {
    const payload = {
      model: MODEL,
      messages,
      temperature: 0.9,
      max_tokens: maxTokens,
      stream: false
    };

    const res = await fetch(API_CHAT, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(payload)
    });

    if (!res.ok) {
      throw new Error("LM HTTP " + res.status + " " + res.statusText);
    }

    const data = await res.json();
    const raw = data?.choices?.[0]?.message?.content || "";
    return cleanText(raw);
  }

  function showTyping() {
    const line = document.createElement("div");
    line.className = "line shadow";
    const span = document.createElement("span");
    span.className = "typing";
    span.innerHTML = "<span class='dot'></span><span class='dot'></span><span class='dot'></span>";
    line.appendChild(span);
    logEl.appendChild(line);
    logEl.scrollTop = logEl.scrollHeight;
    return line;
  }

  function typeOut(line, text, speed = 18) {
    return new Promise((resolve) => {
      let i = 0;
      function step() {
        line.textContent = text.slice(0, i);
        logEl.scrollTop = logEl.scrollHeight;
        if (i < text.length) {
          i++;
          setTimeout(step, speed);
        } else {
          resolve();
        }
      }
      step();
    });
  }

  async function printShadow(text) {
    const line = document.createElement("div");
    line.className = "line shadow";
    logEl.appendChild(line);
    logEl.scrollTop = logEl.scrollHeight;
    await typeOut(line, text, 18);
  }

  async function handleSend() {
    const q = inputEl.value.trim();
    if (!q || sendBtn.disabled) return;

    inputEl.value = "";
    addLine("¬ª " + q, "user");
    addUserMessage(q);

    // Command routing
    if (q.toLowerCase().startsWith("webscan:")) {
      const url = q.split(":").slice(1).join(":").trim();
      return runWebScan(url);
    }

    if (q.toLowerCase().startsWith("search:")) {
      const arg = q.split(":").slice(1).join(":").trim();
      return runSearch(arg);
    }

    const loader = showTyping();
    sendBtn.disabled = true;
    statusLabel.textContent = "thinking";

    try {
      const answer = await callLM(history, 900); // del≈°√≠ odpovƒõdi ‚Äì nezapome≈à m√≠t vysok√Ω context v LM
      loader.remove();
      await printShadow("SHADOW: " + answer);
      addShadowMessage(answer);
      statusLabel.textContent = "online";
    } catch (e) {
      console.error(e);
      loader.remove();
      statusLabel.textContent = "error";
      addLine("[ERR] " + (e.message || "LM selhal."), "system");
    } finally {
      sendBtn.disabled = false;
      trimHistory();
      inputEl.focus();
    }
  }

  async function runWebScan(urlRaw) {
    const url = urlRaw.trim();
    if (!url) {
      addLine("SHADOW: dej mi URL za 'webscan:'", "shadow");
      return;
    }

    addLine(`SHADOW: üì° WebScan ‚Üí ${url}`, "shadow");
    webStatusEl.textContent = "scan‚Ä¶";
    const loader = showTyping();
    sendBtn.disabled = true;
    statusLabel.textContent = "web-scan";

    try {
      const res = await fetch("/.netlify/functions/web-search", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ url, depth: 2 })
      });

      if (!res.ok) {
        loader.remove();
        webStatusEl.textContent = "err";
        addLine(`[WEB] HTTP ${res.status}`, "web");
        statusLabel.textContent = "online";
        sendBtn.disabled = false;
        return;
      }

      const data = await res.json();
      loader.remove();
      const pages = data.pages || [];
      webStatusEl.textContent = `ok:${pages.length}`;

      if (!pages.length) {
        addLine("SHADOW: na t√© adrese nic po≈ô√°dn√©ho.", "shadow");
        statusLabel.textContent = "online";
        sendBtn.disabled = false;
        return;
      }

      const ctx = pages
        .map(p => `URL: ${p.url}\nTEXT:\n${p.text}`)
        .join("\n\n---\n\n")
        .slice(0, 9000);

      statusLabel.textContent = "analyzing";

      const messages = [
        {
          role: "system",
          content: `Jsi SHŒõDOW. M√°≈° hrub√Ω obsah z webu.
Z toho udƒõl√°≈° 4‚Äì8 struƒçn√Ωch, ostr√Ωch bod≈Ø. ≈Ω√°dn√© <think>, ≈æ√°dn√Ω smalltalk.`
        },
        {
          role: "user",
          content: `Tady je obsah z webu:\n\n${ctx}\n\nShr≈à to jako intern√≠ report pro RGS & UFO.`
        }
      ];

      const summary = await callLM(messages, 700);
      await printShadow("SHADOW: " + summary);
      addShadowMessage(summary);
      statusLabel.textContent = "online";

    } catch (e) {
      console.error(e);
      loader.remove();
      webStatusEl.textContent = "err";
      statusLabel.textContent = "error";
      addLine("[WEB ERR] " + (e.message || "WebScan selhal."), "system");
    } finally {
      sendBtn.disabled = false;
      trimHistory();
      inputEl.focus();
    }
  }

  async function runSearch(arg) {
    const query = arg.trim();
    if (!query) {
      addLine("SHADOW: napi≈° dotaz za 'search:'. Nap≈ô. `search: trendy v kyberbezpeƒçnosti`.", "shadow");
      return;
    }

    // pokud to vypad√° jako URL, p≈ôesmƒõruj na webscan
    if (/^https?:\/\//i.test(query) || query.startsWith("www.")) {
      return runWebScan(query);
    }

    addLine(`SHADOW: üîç hled√°m "${query}"‚Ä¶`, "shadow");
    webStatusEl.textContent = "search‚Ä¶";
    const loader = showTyping();
    sendBtn.disabled = true;
    statusLabel.textContent = "search";

    try {
      const res = await fetch("/.netlify/functions/search-engine", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ query })
      });

      if (!res.ok) {
        loader.remove();
        webStatusEl.textContent = "err";
        addLine(`[SEARCH] HTTP ${res.status}`, "web");
        statusLabel.textContent = "online";
        sendBtn.disabled = false;
        return;
      }

      const data = await res.json();
      if (!data.ok) {
        loader.remove();
        webStatusEl.textContent = "err";
        addLine("[SEARCH] backend vr√°til chybu.", "web");
        statusLabel.textContent = "online";
        sendBtn.disabled = false;
        return;
      }

      const pages = (data.pages || []).slice(0, 3);
      webStatusEl.textContent = `ok:${pages.length}`;

      if (!pages.length) {
        loader.remove();
        addLine("SHADOW: nic zaj√≠mav√©ho nena≈°el. Buƒè konkr√©tnƒõj≈°√≠.", "shadow");
        statusLabel.textContent = "online";
        sendBtn.disabled = false;
        return;
      }

      const ctx = pages
        .map(p => `TITLE: ${p.title || ""}\nURL: ${p.url || ""}\nTEXT:\n${p.text || ""}`)
        .join("\n\n---\n\n")
        .slice(0, 9000);

      statusLabel.textContent = "analyzing";

      const messages = [
        {
          role: "system",
          content: `Jsi SHŒõDOW. M√°≈° v√Ωst≈ôi≈æky z nƒõkolika web≈Ø jako v√Ωsledek "hled√°n√≠".
Tv√Ωm √∫kolem je:
- seƒç√≠st informace,
- vyt√°hnout 4‚Äì8 nejd≈Øle≈æitƒõj≈°√≠ch poznatk≈Ø,
- ≈æ√°dn√© <think>, ≈æ√°dn√Ω smalltalk, ≈æ√°dn√© "jsem AI".
Upozorni na rizika, kontext, praktick√© pou≈æit√≠.`
        },
        {
          role: "user",
          content: `Dotaz byl: "${query}". N√≠≈æe jsou texty z v√Ωsledk≈Ø:\n\n${ctx}\n\nShr≈à to pro mƒõ jako intern√≠ anal√Ωzu.`
        }
      ];

      loader.remove();
      const answer = await callLM(messages, 900);
      await printShadow("SHADOW: " + answer);
      addShadowMessage(answer);
      statusLabel.textContent = "online";

    } catch (e) {
      console.error(e);
      loader.remove();
      webStatusEl.textContent = "err";
      statusLabel.textContent = "error";
      addLine("[SEARCH ERR] " + (e.message || "Search selhal."), "system");
    } finally {
      sendBtn.disabled = false;
      trimHistory();
      inputEl.focus();
    }
  }

  // Quick buttons
  document.querySelectorAll(".quick-btn").forEach(btn => {
    btn.addEventListener("click", () => {
      const q = btn.getAttribute("data-q") || "";
      if (!q) return;
      inputEl.value = q;
      handleSend();
    });
  });

  sendBtn.addEventListener("click", handleSend);
  inputEl.addEventListener("keydown", (e) => {
    if (e.key === "Enter" && !e.shiftKey) {
      e.preventDefault();
      handleSend();
    }
  });

  // init LM status
  (async function initStatus() {
    try {
      const res = await fetch(API_CHAT.replace("/v1/chat/completions", "/v1/models"), {
        method: "GET",
        headers: { "Content-Type": "application/json" }
      });
      if (res.ok) {
        const data = await res.json();
        const m = Array.isArray(data.data) && data.data.length ? data.data[0].id : MODEL;
        lmNameEl.textContent = m;
        statusLabel.textContent = "online";
      } else {
        lmNameEl.textContent = "LM " + res.status;
        statusLabel.textContent = "warn";
      }
    } catch (e) {
      lmNameEl.textContent = "LM error";
      statusLabel.textContent = "offline";
    }
    trimHistory();
  })();
</script>
</body>
</html>
